<div class="variants">
    {% for product in collection.products %}
        {% assign color_active = false %}
        {% for option in product.options %}
            {% if option == 'Color' %}
             {% assign color_active = true %}

                {% if product.variants.size > 1 and color_active == true %}
                    {% assign index = forloop.index0 %}
                    {% assign colorlist = '' %}
                    {% assign color = '' %}
                    {% for variant in product.variants %}
                        {% capture color %}
                        {{ variant.options[index] }}
                        {% endcapture %}

                        {% unless colorlist contains color %}
                        <a class="product_card" href="{{variant.url }}">
                            <div>
                                <div class="variant_image">
                                    <img src="{{variant.featured_image | img_url: 'master'}}" alt="variant-title">

                                </div>
                                <div class="variant_title"><strong>{{product.title}}-{{color}}</strong></div>

                                <div class="variant_price">{{variant.price | money}}</div>

                            </div>
                        </a>
                        {% capture tempList %}
                        {{colorlist | append: color | append: " " }}
                        {% endcapture %}
                        {% assign colorlist = tempList %}
                        {% endunless %}

                    {% endfor %}
            
                <a class="product_card" href="{{product.url }}">
                    <div>
                        <div class="variant_image">
                            <img src="{{product.featured_image | img_url: 'master'}}" alt="product-image">

                        </div>
                        <div class="variant_title"><strong>{{product.title}}</strong></div>

                        <div class="variant_price">{{product.price | money}}</div>

                    </div>
                </a>
                {% endif %}
            {% endif %}
        {% endfor %}
    {% endfor %}
</div>
